# ============================================================================
# VitalWatch - Configuración de Aplicación Spring Boot
# ============================================================================

# ============================================================================
# INFORMACIÓN DE LA APLICACIÓN
# ============================================================================
spring.application.name=vitalwatch-backend
server.port=8080

# ============================================================================
# ORACLE CLOUD DATABASE - AUTONOMOUS DATABASE
# ============================================================================
# Información de la Base de Datos:
# - Nombre: s58onuxcx4c1qxe9
# - Región: Santiago, Chile (sa-santiago-1)
# - Host: adb.sa-santiago-1.oraclecloud.com
# - Puerto: 1522 (TCPS - SSL)

# URL de conexión usando Wallet - TCPS con descripción completa
spring.datasource.url=jdbc:oracle:thin:@(description=(retry_count=20)(retry_delay=3)(address=(protocol=tcps)(port=1522)(host=adb.sa-santiago-1.oraclecloud.com))(connect_data=(service_name=g64afca1579a0d2_s58onuxcx4c1qxe9_high.adb.oraclecloud.com))(security=(ssl_server_dn_match=yes)))
spring.datasource.username=ADMIN
spring.datasource.password=$-123.Sb-123

# Driver Oracle
spring.datasource.driver-class-name=oracle.jdbc.OracleDriver

# Connection Pool (HikariCP - default en Spring Boot)
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000

# ============================================================================
# JPA / HIBERNATE
# ============================================================================
spring.jpa.database-platform=org.hibernate.dialect.OracleDialect
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.use_sql_comments=true

# Naming strategy
spring.jpa.hibernate.naming.physical-strategy=org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl

# ============================================================================
# LOGGING
# ============================================================================
logging.level.root=INFO
logging.level.com.hospital.vitalwatch=DEBUG
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE
logging.level.org.springframework.security=DEBUG

# Log pattern
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %msg%n

# ============================================================================
# SPRING SECURITY - JWT / OAuth2
# ============================================================================
# Auth0 Configuration (ajustar según tu configuración)
spring.security.oauth2.resourceserver.jwt.issuer-uri=https://YOUR_AUTH0_DOMAIN/
spring.security.oauth2.resourceserver.jwt.jwk-set-uri=https://YOUR_AUTH0_DOMAIN/.well-known/jwks.json

# O Keycloak Configuration (alternativa)
# spring.security.oauth2.resourceserver.jwt.issuer-uri=http://localhost:8180/realms/vitalwatch
# spring.security.oauth2.resourceserver.jwt.jwk-set-uri=http://localhost:8180/realms/vitalwatch/protocol/openid-connect/certs

# ============================================================================
# CORS CONFIGURATION
# ============================================================================
# Orígenes permitidos (separados por coma)
allowed.origins=http://localhost:4200,http://localhost:80,https://tu-dominio-frontend.com

# ============================================================================
# ACTUATOR (Endpoints de monitoreo)
# ============================================================================
management.endpoints.web.exposure.include=health,info,metrics
management.endpoint.health.show-details=always
management.health.db.enabled=true

# ============================================================================
# SWAGGER / OpenAPI
# ============================================================================
springdoc.api-docs.path=/v3/api-docs
springdoc.swagger-ui.path=/swagger-ui.html
springdoc.swagger-ui.enabled=true

# ============================================================================
# MULTIPART FILE UPLOAD (si necesitas subir archivos)
# ============================================================================
spring.servlet.multipart.enabled=true
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB

# ============================================================================
# JACKSON (JSON Serialization)
# ============================================================================
spring.jackson.serialization.write-dates-as-timestamps=false
spring.jackson.time-zone=America/Santiago
spring.jackson.default-property-inclusion=non_null

# ============================================================================
# TIMEZONE
# ============================================================================
spring.jpa.properties.hibernate.jdbc.time_zone=America/Santiago

# ============================================================================
# NOTAS DE CONFIGURACIÓN
# ============================================================================
#
# PARA USAR EL WALLET DE ORACLE CLOUD:
# 
# 1. Asegúrate de que la carpeta Wallet_S58ONUXCX4C1QXE9 esté en el mismo 
#    directorio que tu JAR o en la raíz del proyecto.
#
# 2. La URL debe usar el formato: 
#    jdbc:oracle:thin:@[NOMBRE_SERVICIO]?TNS_ADMIN=[RUTA_AL_WALLET]
#
#    Servicios disponibles:
#    - s58onuxcx4c1qxe9_high    (Alto rendimiento)
#    - s58onuxcx4c1qxe9_medium  (Medio)
#    - s58onuxcx4c1qxe9_low     (Bajo - recomendado para desarrollo)
#
# 3. Si el Wallet está en otra ubicación:
#    TNS_ADMIN=/ruta/completa/al/Wallet_S58ONUXCX4C1QXE9
#
# 4. IMPORTANTE: No subir este archivo con credenciales a Git.
#    Usar variables de entorno o application-{profile}.properties
#
# ============================================================================

# ============================================================================
# PERFILES (PROFILES)
# ============================================================================
# Para activar un perfil:
# - En desarrollo: application-dev.properties
# - En producción: application-prod.properties
# 
# Ejecutar con: java -jar app.jar --spring.profiles.active=prod
# O en IntelliJ: Run > Edit Configurations > Active profiles: prod
# ============================================================================
